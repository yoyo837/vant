import{A as K,y as w,D as j,u as F,q as _,M as G,J as V,L as H,P as M,e as s,S as N,F as $,B as O,T as q,j as J,v as U}from"./vue-libs-19c20d28.js";import{n as C,t as u,u as Y,m as y,w as Z}from"./with-install-560d59bf.js";import{m as Q,e as W,c as X,i as ee}from"./use-translate-71d4880c.js";import{u as oe}from"./use-expose-80cfd2b2.js";import{u as ne}from"./use-lock-scroll-01f1fb06.js";import{u as te}from"./use-lazy-render-e63df66f.js";import{P as ae}from"./on-popup-reopen-6f4c2d78.js";import{u as se,I as le}from"./index-1ef61aa2.js";import{u as x}from"./use-scope-id-dc406604.js";import{O as re}from"./index-cd342d67.js";import{c as ce}from"./interceptor-5424332a.js";import{H as ie}from"./constant-ee6e27d7.js";const S={show:Boolean,zIndex:C,overlay:u,duration:C,teleport:[String,Object],lockScroll:u,lazyRender:u,beforeClose:Function,overlayStyle:Object,overlayClass:Y,transitionAppear:Boolean,closeOnClickOverlay:u},Se=Object.keys(S),ue=W({},S,{round:Boolean,position:y("center"),closeIcon:y("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:y("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[de,b]=X("popup"),fe=K({name:de,inheritAttrs:!1,props:ue,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:n,attrs:p,slots:l}){let a,r;const d=w(),c=w(),A=te(()=>e.show||!e.lazyRender),B=j(()=>{const o={zIndex:d.value};if(ee(e.duration)){const t=e.position==="center"?"animationDuration":"transitionDuration";o[t]=`${e.duration}s`}return o}),P=()=>{a||(a=!0,d.value=e.zIndex!==void 0?+e.zIndex:se(),n("open"))},i=()=>{a&&ce(e.beforeClose,{done(){a=!1,n("close"),n("update:show",!1)}})},T=o=>{n("clickOverlay",o),e.closeOnClickOverlay&&i()},I=()=>{if(e.overlay)return s(re,O({show:e.show,class:e.overlayClass,zIndex:d.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},x(),{onClick:T}),{default:l["overlay-content"]})},z=o=>{n("clickCloseIcon",o),i()},g=()=>{if(e.closeable)return s(le,{role:"button",tabindex:0,name:e.closeIcon,class:[b("close-icon",e.closeIconPosition),ie],classPrefix:e.iconPrefix,onClick:z},null)};let f;const D=()=>{f&&clearTimeout(f),f=setTimeout(()=>{n("opened")})},E=()=>n("closed"),L=o=>n("keydown",o),R=A(()=>{var k;const{round:o,position:t,safeAreaInsetTop:m,safeAreaInsetBottom:v}=e;return J(s("div",O({ref:c,style:B.value,role:"dialog",tabindex:0,class:[b({round:o,[t]:t}),{"van-safe-area-top":m,"van-safe-area-bottom":v}],onKeydown:L},p,x()),[(k=l.default)==null?void 0:k.call(l),g()]),[[U,e.show]])}),h=()=>{const{position:o,transition:t,transitionAppear:m}=e,v=o==="center"?"van-fade":`van-popup-slide-${o}`;return s(q,{name:t||v,appear:m,onAfterEnter:D,onAfterLeave:E},{default:R})};return F(()=>e.show,o=>{o&&!a&&(P(),p.tabindex===0&&_(()=>{var t;(t=c.value)==null||t.focus()})),!o&&a&&(a=!1,n("close"))}),oe({popupRef:c}),ne(c,()=>e.show&&e.lockScroll),Q("popstate",()=>{e.closeOnPopstate&&(i(),r=!1)}),G(()=>{e.show&&P()}),V(()=>{r&&(n("update:show",!0),r=!1)}),H(()=>{e.show&&e.teleport&&(i(),r=!0)}),M(ae,()=>e.show),()=>e.teleport?s(N,{to:e.teleport},{default:()=>[I(),h()]}):s($,null,[I(),h()])}}),me=Z(fe),Ae=me;export{me as P,Ae as V,Se as a,S as p};
